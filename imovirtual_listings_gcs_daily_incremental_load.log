2025-05-17 15:06:38,736 - INFO - [main.py:428] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:06:38,736 - INFO - [main.py:429] - <module>() - Using subfolder path: staging/imovirtual
2025-05-17 15:06:38,736 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual/
2025-05-17 15:06:38,779 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:06:40,138 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:06:40,138 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual/imovirtual_2025-05-17.parquet (created: 2025-05-17 07:17:12.572000+00:00)
2025-05-17 15:06:40,139 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual/imovirtual_2025-05-16.parquet (created: 2025-05-16 07:20:51.928000+00:00)
2025-05-17 15:06:40,139 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual/imovirtual_2025-05-15.parquet (created: 2025-05-15 07:19:39.163000+00:00)
2025-05-17 15:06:40,139 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual/imovirtual_2025-05-14.parquet (created: 2025-05-14 07:17:57.801000+00:00)
2025-05-17 15:06:40,139 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual/imovirtual_2025-05-12.parquet (created: 2025-05-12 07:18:49.836000+00:00)
2025-05-17 15:06:40,139 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:06:40,139 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:06:40,139 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:06:40,139 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 5236857 bytes
2025-05-17 15:06:40,139 - INFO - [main.py:207] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:06:40,170 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:06:41,507 - INFO - [main.py:234] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 13563 rows
2025-05-17 15:07:11,380 - INFO - [main.py:428] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:07:11,380 - INFO - [main.py:429] - <module>() - Using subfolder path: staging/imovirtual
2025-05-17 15:07:11,381 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual/
2025-05-17 15:07:11,413 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:07:12,732 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:07:12,733 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual/imovirtual_2025-05-17.parquet (created: 2025-05-17 07:17:12.572000+00:00)
2025-05-17 15:07:12,733 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual/imovirtual_2025-05-16.parquet (created: 2025-05-16 07:20:51.928000+00:00)
2025-05-17 15:07:12,733 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual/imovirtual_2025-05-15.parquet (created: 2025-05-15 07:19:39.163000+00:00)
2025-05-17 15:07:12,733 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual/imovirtual_2025-05-14.parquet (created: 2025-05-14 07:17:57.801000+00:00)
2025-05-17 15:07:12,733 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual/imovirtual_2025-05-12.parquet (created: 2025-05-12 07:18:49.836000+00:00)
2025-05-17 15:07:12,733 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:07:12,733 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:07:12,733 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:07:12,733 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 5236857 bytes
2025-05-17 15:07:12,733 - INFO - [main.py:207] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:07:12,764 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:07:13,810 - INFO - [main.py:234] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 13563 rows
2025-05-17 15:10:27,796 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:10:27,796 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual
2025-05-17 15:10:27,796 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual/
2025-05-17 15:10:27,829 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:10:29,167 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:10:29,167 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual/imovirtual_2025-05-17.parquet (created: 2025-05-17 07:17:12.572000+00:00)
2025-05-17 15:10:29,167 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual/imovirtual_2025-05-16.parquet (created: 2025-05-16 07:20:51.928000+00:00)
2025-05-17 15:10:29,167 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual/imovirtual_2025-05-15.parquet (created: 2025-05-15 07:19:39.163000+00:00)
2025-05-17 15:10:29,167 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual/imovirtual_2025-05-14.parquet (created: 2025-05-14 07:17:57.801000+00:00)
2025-05-17 15:10:29,167 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual/imovirtual_2025-05-12.parquet (created: 2025-05-12 07:18:49.836000+00:00)
2025-05-17 15:10:29,168 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:10:29,168 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:10:29,168 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 07:17:12.572000+00:00
2025-05-17 15:10:29,168 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 5236857 bytes
2025-05-17 15:10:29,168 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual/imovirtual_2025-05-17.parquet
2025-05-17 15:10:29,204 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:10:30,242 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 13563 rows
2025-05-17 15:13:20,686 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:13:20,686 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:13:20,686 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:13:20,686 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:13:20,721 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:13:21,164 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:13:21,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:13:21,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:13:21,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:13:21,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:13:21,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:13:21,164 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:13:21,164 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:13:21,164 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:13:21,164 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:13:21,164 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:13:21,196 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:13:27,634 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:17:05,907 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:17:05,907 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:17:05,907 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:17:05,907 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:17:05,939 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:17:06,370 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:17:06,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:17:06,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:17:06,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:17:06,371 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:17:06,371 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:17:06,371 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:17:06,371 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:17:06,371 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:17:06,371 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:17:06,371 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:17:06,402 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:17:12,767 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:17:16,664 - ERROR - [main.py:389] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: "None of [Index(['slug', 'ingestionDate'], dtype='object')] are in the [columns]"
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 307, in check_existing_keys_in_bigquery
    key_pairs = df[['slug', 'ingestionDate']].drop_duplicates()
                ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/home/miguel/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6249, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['slug', 'ingestionDate'], dtype='object')] are in the [columns]"
2025-05-17 15:21:08,697 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:21:08,697 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:21:08,697 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:21:08,697 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:21:08,729 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:21:09,191 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:21:09,191 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:21:09,191 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:21:09,191 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:21:09,191 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:21:09,191 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:21:09,191 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:21:09,192 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:21:09,192 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:21:09,192 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:21:09,192 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:21:09,223 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:21:15,575 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:21:19,491 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 15:21:20,139 - INFO - [main.py:346] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 15:21:23,227 - INFO - [main.py:368] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 15:21:24,046 - INFO - [main.py:377] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 15:21:24,150 - INFO - [main.py:382] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.staging_housing_temp.temp_lookup_1747491679
2025-05-17 15:21:24,150 - INFO - [main.py:404] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 15:21:24,184 - INFO - [main.py:412] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 15:24:46,328 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:24:46,329 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:24:46,329 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:24:46,329 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:24:46,367 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:24:46,823 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:24:46,823 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:24:46,823 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:24:46,823 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:24:46,823 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:24:46,823 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:24:46,823 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:24:46,823 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:24:46,823 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:24:46,824 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:24:46,824 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:24:46,855 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:24:53,602 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:24:57,833 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 15:24:58,378 - INFO - [main.py:346] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 15:25:01,104 - INFO - [main.py:368] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 15:25:02,382 - INFO - [main.py:377] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 15:25:02,470 - INFO - [main.py:382] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.staging_housing_temp.temp_lookup_1747491897
2025-05-17 15:25:02,470 - INFO - [main.py:404] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 15:25:02,506 - INFO - [main.py:412] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 15:25:57,237 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:25:57,237 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:25:57,237 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:25:57,237 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:25:57,271 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:25:57,724 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:25:57,724 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:25:57,724 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:25:57,724 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:25:57,725 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:25:57,725 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:25:57,725 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:25:57,725 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:25:57,725 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:25:57,725 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:25:57,725 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:25:57,759 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:26:04,290 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:29:27,097 - INFO - [main.py:425] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:29:27,097 - INFO - [main.py:426] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:29:27,097 - INFO - [main.py:433] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:29:27,097 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:29:27,133 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:29:27,595 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:29:27,595 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:29:27,595 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:29:27,595 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:29:27,596 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:29:27,596 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:29:27,596 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:29:27,596 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:29:27,596 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:29:27,596 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:29:27,596 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:29:27,630 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:29:34,055 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 15:30:36,218 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 15:30:36,218 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 15:30:36,218 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 15:30:36,218 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 15:30:36,253 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:30:36,686 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 15:30:36,686 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 15:30:36,687 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 15:30:36,687 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 15:30:36,687 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 15:30:36,687 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 15:30:36,687 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:30:36,687 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:30:36,687 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 15:30:36,687 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 15:30:36,687 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 15:30:36,721 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 15:30:43,191 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:08:09,923 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:08:09,923 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:08:09,923 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:08:09,923 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:08:09,955 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:08:10,399 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:08:10,400 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:08:10,400 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:08:10,400 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:08:10,400 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:08:10,400 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:08:10,400 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:08:10,400 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:08:10,400 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:08:10,400 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:08:10,400 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:08:10,431 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:08:16,757 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:09:23,523 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:09:23,523 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:09:23,523 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:09:23,523 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:09:23,559 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:09:24,000 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:09:24,000 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:09:24,000 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:09:24,000 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:09:24,000 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:09:24,001 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:09:24,001 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:09:24,001 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:09:24,001 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:09:24,001 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:09:24,001 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:09:24,033 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:09:30,417 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:09:34,220 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:09:36,672 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:09:39,463 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:09:40,727 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: 404 Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 74f58cb6-435c-4b17-a3fc-b8564abb21f6
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 374, in check_existing_keys_in_bigquery
    for row in query_job:
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 2166, in __iter__
    return iter(self.result())
                ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1681, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1630, in is_job_done
    raise job_failed_exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 74f58cb6-435c-4b17-a3fc-b8564abb21f6

2025-05-17 16:10:04,908 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:10:04,909 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:10:04,909 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:10:04,909 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:10:04,941 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:10:05,406 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:10:05,407 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:10:05,407 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:10:05,407 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:10:05,407 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:10:05,407 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:10:05,407 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:10:05,407 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:10:05,407 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:10:05,407 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:10:05,407 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:10:05,438 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:10:11,744 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:10:15,565 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:10:16,157 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:10:19,524 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:10:20,581 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: 404 Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 3ee89aa4-efae-4aac-ac82-941f14df8b23
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 374, in check_existing_keys_in_bigquery
    for row in query_job:
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 2166, in __iter__
    return iter(self.result())
                ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1681, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1630, in is_job_done
    raise job_failed_exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Dataset poised-space-456813-t0:staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 3ee89aa4-efae-4aac-ac82-941f14df8b23

2025-05-17 16:12:33,402 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:12:33,402 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:12:33,402 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:12:33,402 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:12:33,435 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:12:33,876 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:12:33,876 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:12:33,876 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:12:33,876 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:12:33,876 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:12:33,876 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:12:33,876 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:12:33,876 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:12:33,876 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:12:33,876 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:12:33,876 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:12:33,913 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:12:40,233 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:12:44,655 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:12:46,960 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:12:50,155 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:12:50,841 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: 404 Not found: Table poised-space-456813-t0:imovirtual_listings.staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Table poised-space-456813-t0:imovirtual_listings.staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 14578319-4e42-49ba-b85d-72c50329e736
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 374, in check_existing_keys_in_bigquery
    for row in query_job:
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 2166, in __iter__
    return iter(self.result())
                ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1681, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1630, in is_job_done
    raise job_failed_exception
google.api_core.exceptions.NotFound: 404 Not found: Table poised-space-456813-t0:imovirtual_listings.staging_imovirtual_listings was not found in location europe-southwest1; reason: notFound, message: Not found: Table poised-space-456813-t0:imovirtual_listings.staging_imovirtual_listings was not found in location europe-southwest1

Location: europe-southwest1
Job ID: 14578319-4e42-49ba-b85d-72c50329e736

2025-05-17 16:16:37,464 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:16:37,464 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:16:37,464 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:16:37,464 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:16:37,498 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:16:37,956 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:16:37,957 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:16:37,957 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:16:37,957 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:16:37,957 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:16:37,957 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:16:37,957 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:16:37,957 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:16:37,957 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:16:37,957 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:16:37,957 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:16:37,989 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:16:44,513 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:16:48,720 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:16:49,281 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:16:51,594 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:16:51,801 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: 400 Name slug not found inside t at [5:14]; reason: invalidQuery, location: query, message: Name slug not found inside t at [5:14]

Location: europe-southwest1
Job ID: 46c3bd67-4211-478f-ad64-99aab3536793
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 374, in check_existing_keys_in_bigquery
    for row in query_job:
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 2166, in __iter__
    return iter(self.result())
                ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1681, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1630, in is_job_done
    raise job_failed_exception
google.api_core.exceptions.BadRequest: 400 Name slug not found inside t at [5:14]; reason: invalidQuery, location: query, message: Name slug not found inside t at [5:14]

Location: europe-southwest1
Job ID: 46c3bd67-4211-478f-ad64-99aab3536793

2025-05-17 16:19:23,702 - INFO - [main.py:426] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:19:23,703 - INFO - [main.py:427] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:19:23,703 - INFO - [main.py:434] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:19:23,703 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:19:23,735 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:19:24,164 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:19:24,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:19:24,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:19:24,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:19:24,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:19:24,164 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:19:24,165 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:19:24,165 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:19:24,165 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:19:24,165 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:19:24,165 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:19:24,196 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:19:30,589 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:19:34,483 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:19:35,003 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:19:37,124 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:19:38,161 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:19:38,252 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747495174
2025-05-17 16:19:38,252 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:19:38,286 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:19:38,287 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:19:38,317 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:19:38,597 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 89, in pyarrow.lib.check_status
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
2025-05-17 16:33:59,879 - INFO - [main.py:427] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:33:59,879 - INFO - [main.py:428] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:33:59,879 - INFO - [main.py:435] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:33:59,879 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:33:59,916 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:34:00,392 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:34:00,392 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:34:00,392 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:34:00,392 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:34:00,392 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:34:00,393 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:34:00,393 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:34:00,393 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:34:00,393 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:34:00,393 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:34:00,393 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:34:00,430 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:34:06,867 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:34:10,715 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:34:11,285 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:34:13,516 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:34:14,011 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:34:14,100 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496050
2025-05-17 16:34:14,100 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:34:14,134 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:34:14,135 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:34:14,166 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:34:14,445 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 89, in pyarrow.lib.check_status
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
2025-05-17 16:35:25,783 - INFO - [main.py:480] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:35:25,783 - INFO - [main.py:481] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:35:25,783 - INFO - [main.py:488] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:35:25,783 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:35:25,816 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:35:26,253 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:35:26,253 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:35:26,253 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:35:26,253 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:35:26,253 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:35:26,253 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:35:26,253 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:35:26,253 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:35:26,253 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:35:26,253 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:35:26,253 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:35:26,285 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:35:32,696 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:35:36,651 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:35:37,061 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:35:40,634 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:35:41,166 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:35:41,259 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496136
2025-05-17 16:35:41,260 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:35:41,296 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:35:41,296 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:35:41,328 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:35:41,602 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 89, in pyarrow.lib.check_status
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 557-558: surrogates not allowed
2025-05-17 16:36:54,904 - INFO - [main.py:497] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:36:54,904 - INFO - [main.py:498] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:36:54,904 - INFO - [main.py:505] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:36:54,904 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:36:54,936 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:36:55,355 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:36:55,355 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:36:55,355 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:36:55,355 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:36:55,355 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:36:55,355 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:36:55,355 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:36:55,355 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:36:55,356 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:36:55,356 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:36:55,356 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:36:55,386 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:37:01,755 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:37:05,670 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:37:06,174 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:37:09,401 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:37:09,874 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:37:09,954 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496225
2025-05-17 16:37:09,954 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:37:09,999 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:37:09,999 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:37:10,029 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:37:10,374 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "created_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:37:10,374 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "created_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "created_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:38:51,909 - INFO - [main.py:497] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:38:51,910 - INFO - [main.py:498] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:38:51,910 - INFO - [main.py:505] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:38:51,910 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:38:51,943 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:38:52,369 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:38:52,369 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:38:52,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:38:52,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:38:52,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:38:52,370 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:38:52,370 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:38:52,370 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:38:52,370 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:38:52,370 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:38:52,370 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:38:52,402 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:38:58,736 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:39:02,701 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:39:03,166 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:39:05,922 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:39:06,948 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:39:07,027 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496342
2025-05-17 16:39:07,027 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:39:07,068 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:39:07,068 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:39:07,101 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:39:07,389 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:39:07,390 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:39:41,770 - INFO - [main.py:497] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:39:41,770 - INFO - [main.py:498] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:39:41,770 - INFO - [main.py:505] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:39:41,770 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:39:41,808 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:39:42,259 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:39:42,259 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:39:42,259 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:39:42,259 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:39:42,259 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:39:42,259 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:39:42,259 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:39:42,259 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:39:42,259 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:39:42,260 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:39:42,260 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:39:42,297 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:39:48,632 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:39:52,750 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:39:53,301 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:39:56,319 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:39:57,344 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:39:57,441 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496392
2025-05-17 16:39:57,441 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:39:57,485 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:39:57,485 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:39:57,517 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:39:57,820 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:39:57,820 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "modified_at" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:40:24,675 - INFO - [main.py:497] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:40:24,675 - INFO - [main.py:498] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:40:24,675 - INFO - [main.py:505] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:40:24,675 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:40:24,708 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:40:25,122 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:40:25,123 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:40:25,123 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:40:25,123 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:40:25,123 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:40:25,123 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:40:25,123 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:40:25,123 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:40:25,123 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:40:25,123 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:40:25,123 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:40:25,155 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:40:31,655 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:40:35,559 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:40:36,065 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:40:37,963 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:40:38,428 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:40:38,524 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496435
2025-05-17 16:40:38,524 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:40:38,572 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:40:38,572 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:40:38,603 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:40:38,958 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "ingestionDate" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:40:38,958 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "ingestionDate" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "ingestionDate" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-17 16:40:53,532 - INFO - [main.py:497] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-17 16:40:53,532 - INFO - [main.py:498] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-17 16:40:53,532 - INFO - [main.py:505] - <module>() - reading from path staging/imovirtual_listings
2025-05-17 16:40:53,532 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-17 16:40:53,569 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:40:54,015 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-17 16:40:54,015 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-17 16:40:54,015 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-17 16:40:54,015 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-17 16:40:54,015 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-17 16:40:54,015 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-17 16:40:54,016 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:40:54,016 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:40:54,016 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-17 16:40:54,016 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-17 16:40:54,016 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-17 16:40:54,051 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-17 16:41:00,540 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-17 16:41:04,713 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:41:05,192 - INFO - [main.py:348] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-17 16:41:08,273 - INFO - [main.py:370] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-17 16:41:08,886 - INFO - [main.py:379] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-17 16:41:08,971 - INFO - [main.py:384] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747496464
2025-05-17 16:41:08,971 - INFO - [main.py:406] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-17 16:41:09,038 - INFO - [main.py:414] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-17 16:41:09,038 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:41:09,087 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-17 16:41:12,464 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-17 16:41:12,464 - INFO - [main.py:277] - load_to_bigquery() - Table now has 6169 rows total
2025-05-17 16:41:12,464 - INFO - [main.py:543] - <module>() - Processing completed successfully
2025-05-18 21:12:50,596 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:12:50,633 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:12:50,633 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:12:50,633 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:12:50,696 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:12:51,220 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:12:51,220 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:12:51,220 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:12:51,220 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:12:51,220 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:12:51,220 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:12:51,220 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:12:51,220 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:12:51,220 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:12:51,220 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:12:51,220 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:12:51,252 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:12:58,158 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:13:08,402 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:13:09,004 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:13:12,162 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:13:13,345 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 6163 existing key pairs in BigQuery
2025-05-18 21:13:13,440 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747599188
2025-05-18 21:13:13,440 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 6163 duplicate keys from 6169 rows
2025-05-18 21:13:13,495 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:13:13,495 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:13:13,526 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:13:17,579 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:13:17,579 - INFO - [main.py:277] - load_to_bigquery() - Table now has 12338 rows total
2025-05-18 21:13:17,579 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 21:20:59,846 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:20:59,846 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:20:59,846 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:20:59,846 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:20:59,881 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:21:00,359 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:21:00,359 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:21:00,359 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:21:00,359 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:21:00,359 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:21:00,359 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:21:00,359 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:21:00,359 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:21:00,359 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:21:00,359 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:21:00,359 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:21:00,403 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:21:06,745 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:21:17,124 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:21:17,666 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:21:20,106 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:21:21,149 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 0 existing key pairs in BigQuery
2025-05-18 21:21:21,227 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747599677
2025-05-18 21:21:21,227 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 0 duplicate keys from 6169 rows
2025-05-18 21:21:21,280 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:21:21,281 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:21:21,311 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:21:24,758 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:21:24,758 - INFO - [main.py:277] - load_to_bigquery() - Table now has 6169 rows total
2025-05-18 21:21:24,758 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 21:27:17,251 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:27:17,251 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:27:17,251 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:27:17,251 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:27:17,284 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:27:17,744 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:27:17,745 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:27:17,745 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:27:17,745 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:27:17,745 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:27:17,745 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:27:17,745 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:27:17,745 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:27:17,745 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:27:17,745 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:27:17,745 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:27:17,777 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:27:24,194 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:27:35,274 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:27:35,811 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:27:38,701 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:27:39,949 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 6163 existing key pairs in BigQuery
2025-05-18 21:27:40,041 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747600055
2025-05-18 21:27:40,041 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 6163 duplicate keys from 6169 rows
2025-05-18 21:27:40,102 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:27:40,102 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:27:40,134 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:27:43,943 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:27:43,943 - INFO - [main.py:277] - load_to_bigquery() - Table now has 12338 rows total
2025-05-18 21:27:43,943 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 21:33:56,620 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:33:56,620 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:33:56,620 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:33:56,620 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:33:56,652 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:33:57,099 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:33:57,099 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:33:57,100 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:33:57,100 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:33:57,100 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:33:57,100 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:33:57,100 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:33:57,100 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:33:57,100 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:33:57,100 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:33:57,100 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:33:57,131 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:34:03,440 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:34:11,913 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:34:12,497 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:34:15,624 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:34:17,785 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 12326 existing key pairs in BigQuery
2025-05-18 21:34:17,877 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747600451
2025-05-18 21:34:17,878 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 12326 duplicate keys from 6169 rows
2025-05-18 21:34:17,930 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:34:17,930 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:34:17,960 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:34:20,794 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:34:20,794 - INFO - [main.py:277] - load_to_bigquery() - Table now has 18507 rows total
2025-05-18 21:34:20,794 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 21:40:49,511 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:40:49,512 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:40:49,512 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:40:49,512 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:40:49,544 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:40:49,982 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:40:49,982 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:40:49,983 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:40:49,983 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:40:49,983 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:40:49,983 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:40:49,983 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:40:49,983 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:40:49,983 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:40:49,983 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:40:49,983 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:40:50,017 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:40:56,290 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:41:02,263 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:41:02,263 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:41:02,263 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:41:02,263 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:41:02,298 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:41:02,713 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:41:02,713 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:41:02,714 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:41:02,714 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:41:02,714 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:41:02,714 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:41:02,714 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:41:02,714 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:41:02,714 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:41:02,714 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:41:02,714 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:41:02,746 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:41:09,351 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:41:32,584 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:41:32,584 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:41:32,584 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:41:32,584 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:41:32,616 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:41:33,345 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:41:33,345 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:41:33,345 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:41:33,345 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:41:33,345 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:41:33,345 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:41:33,345 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:41:33,345 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:41:33,345 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:41:33,345 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:41:33,345 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:41:33,376 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:41:39,678 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:42:11,259 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:42:11,259 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:42:11,259 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:42:11,259 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:42:11,294 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:11,706 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:42:11,706 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:42:11,706 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:42:11,706 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:42:11,706 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:42:11,706 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:42:11,706 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:11,706 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:11,706 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:11,706 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:42:11,706 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:11,737 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:17,955 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:42:29,975 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:42:29,975 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:42:29,975 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:42:29,975 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:42:30,007 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:30,419 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:42:30,419 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:42:30,419 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:42:30,419 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:42:30,419 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:42:30,419 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:42:30,419 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:30,419 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:30,419 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:30,419 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:42:30,419 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:30,450 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:36,783 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:42:49,143 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:42:49,144 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:42:49,144 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:42:49,144 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:42:49,176 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:49,620 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:42:49,620 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:42:49,620 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:42:49,620 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:42:49,620 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:42:49,620 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:42:49,620 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:49,620 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:49,621 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:42:49,621 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:42:49,621 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:42:49,651 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:42:56,209 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:46:39,116 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:46:39,116 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:46:39,116 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:46:39,116 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:46:39,148 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:46:39,591 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:46:39,591 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:46:39,591 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:46:39,591 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:46:39,591 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:46:39,591 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:46:39,591 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:46:39,591 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:46:39,591 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:46:39,591 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:46:39,591 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:46:39,623 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:46:45,931 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:46:55,179 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:46:55,179 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:46:55,179 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:46:55,179 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:46:55,211 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:46:55,657 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:46:55,658 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:46:55,658 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:46:55,658 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:46:55,658 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:46:55,658 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:46:55,658 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:46:55,658 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:46:55,658 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:46:55,658 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:46:55,658 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:46:55,689 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:47:02,069 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:47:26,660 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:47:26,660 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:47:26,660 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:47:26,660 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:47:26,694 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:47:27,129 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:47:27,129 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:47:27,129 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:47:27,129 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:47:27,129 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:47:27,130 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:47:27,130 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:47:27,130 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:47:27,130 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:47:27,130 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:47:27,130 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:47:27,164 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:47:33,542 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:51:11,334 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:51:11,334 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:51:11,334 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:51:11,334 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:51:11,368 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:51:11,810 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:51:11,810 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:51:11,810 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:51:11,810 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:51:11,810 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:51:11,810 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:51:11,810 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:51:11,810 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:51:11,810 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:51:11,810 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:51:11,810 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:51:11,842 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:51:18,321 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:51:26,226 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:51:26,226 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:51:26,226 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:51:26,226 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:51:26,258 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:51:26,695 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:51:26,695 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:51:26,695 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:51:26,695 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:51:26,696 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:51:26,696 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:51:26,696 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:51:26,696 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:51:26,696 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:51:26,696 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:51:26,696 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:51:26,727 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:51:33,199 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:51:41,510 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:51:42,113 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:51:44,844 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:51:47,075 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 18489 existing key pairs in BigQuery
2025-05-18 21:51:47,173 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747601501
2025-05-18 21:51:47,173 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 18489 duplicate keys from 6169 rows
2025-05-18 21:51:47,227 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:51:47,227 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:51:47,257 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:51:50,736 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:51:50,736 - INFO - [main.py:277] - load_to_bigquery() - Table now has 24676 rows total
2025-05-18 21:51:50,736 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 21:59:05,537 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 21:59:05,537 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 21:59:05,537 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 21:59:05,537 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 21:59:05,570 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:59:06,032 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 21:59:06,032 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 21:59:06,032 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 21:59:06,032 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 21:59:06,032 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 21:59:06,032 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 21:59:06,032 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:59:06,032 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:59:06,032 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 21:59:06,032 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 21:59:06,032 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 21:59:06,065 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 21:59:12,523 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 21:59:20,973 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:59:21,485 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 21:59:24,825 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 21:59:26,770 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 24652 existing key pairs in BigQuery
2025-05-18 21:59:26,869 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747601960
2025-05-18 21:59:26,870 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 24652 duplicate keys from 6169 rows
2025-05-18 21:59:26,924 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 21:59:26,924 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:59:26,956 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 21:59:29,400 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6169 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 21:59:29,401 - INFO - [main.py:277] - load_to_bigquery() - Table now has 30845 rows total
2025-05-18 21:59:29,401 - INFO - [main.py:542] - <module>() - Processing completed successfully
2025-05-18 22:00:36,844 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:00:36,844 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:00:36,844 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:00:36,844 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:00:36,876 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:00:37,356 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:00:37,357 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:00:37,357 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:00:37,357 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:00:37,357 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:00:37,357 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:00:37,357 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:00:37,357 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:00:37,357 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:00:37,357 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:00:37,357 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:00:37,388 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:00:44,590 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:01:04,988 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:01:04,988 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:01:04,988 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:01:04,988 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:01:05,023 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:01:05,449 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:01:05,449 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:01:05,449 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:01:05,449 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:01:05,449 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:01:05,449 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:01:05,450 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:01:05,450 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:01:05,450 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:01:05,450 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:01:05,450 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:01:05,481 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:01:11,812 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:01:27,199 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:01:27,199 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:01:27,199 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:01:27,199 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:01:27,231 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:01:27,650 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:01:27,650 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:01:27,650 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:01:27,650 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:01:27,650 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:01:27,650 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:01:27,650 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:01:27,650 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:01:27,650 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:01:27,650 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:01:27,650 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:01:27,681 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:01:34,018 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:01:50,101 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:01:50,619 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:01:52,446 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:01:54,642 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 30815 existing key pairs in BigQuery
2025-05-18 22:01:54,731 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747602110
2025-05-18 22:01:54,732 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 30815 duplicate keys from 6169 rows
2025-05-18 22:01:54,789 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 22:01:54,789 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:01:54,821 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:01:55,237 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:01:55,238 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 377, in bq_to_arrow_array
    return pyarrow.ListArray.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: Expected bytes, got a 'dict' object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:02:59,295 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:02:59,295 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:02:59,295 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:02:59,295 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:02:59,329 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:02:59,794 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:02:59,794 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:02:59,794 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:02:59,794 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:02:59,794 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:02:59,794 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:02:59,795 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:02:59,795 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:02:59,795 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:02:59,795 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:02:59,795 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:02:59,829 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:03:06,150 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:03:22,423 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:03:22,882 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:03:26,516 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:03:28,696 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 30815 existing key pairs in BigQuery
2025-05-18 22:03:28,777 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747602202
2025-05-18 22:03:28,777 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 30815 duplicate keys from 6169 rows
2025-05-18 22:03:28,839 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6169 rows
2025-05-18 22:03:28,877 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:03:28,911 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:03:29,255 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:03:29,255 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 377, in bq_to_arrow_array
    return pyarrow.ListArray.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: Expected bytes, got a 'dict' object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:06:08,047 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:06:08,047 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:06:08,047 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:06:08,047 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:06:08,083 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:06:08,541 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:06:08,541 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:06:08,541 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:06:08,541 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:06:08,541 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:06:08,541 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:06:08,541 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:06:08,542 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:06:08,542 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:06:08,542 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:06:08,542 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:06:08,574 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:06:14,883 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:06:31,134 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:06:31,694 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:06:31,694 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "id" and datatype: "float64" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:06:31,695 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: Error converting Pandas column with name: "id" and datatype: "float64" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 380, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: Expected a string or bytes dtype, got float64

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 354, in check_existing_keys_in_bigquery
    load_job = bq_client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "id" and datatype: "float64" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:07:19,543 - INFO - [main.py:496] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:07:19,543 - INFO - [main.py:497] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:07:19,543 - INFO - [main.py:504] - <module>() - reading from path staging/imovirtual_listings
2025-05-18 22:07:19,543 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:07:19,575 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:07:20,007 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:07:20,008 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:07:20,008 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:07:20,008 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:07:20,008 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:07:20,008 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:07:20,008 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:07:20,008 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:07:20,008 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:07:20,008 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:07:20,008 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:07:20,039 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:07:26,480 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:07:42,684 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:07:43,187 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:07:45,162 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:07:45,400 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: 400 Name slug not found inside l at [5:23]; reason: invalidQuery, location: query, message: Name slug not found inside l at [5:23]

Location: europe-southwest1
Job ID: 67ce5918-cad2-4879-8ad1-0a8d3f21df92
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 374, in check_existing_keys_in_bigquery
    for row in query_job:
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 2166, in __iter__
    return iter(self.result())
                ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1681, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 293, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 153, in retry_target
    _retry_error_helper(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 212, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/miguel/.local/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 144, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1630, in is_job_done
    raise job_failed_exception
google.api_core.exceptions.BadRequest: 400 Name slug not found inside l at [5:23]; reason: invalidQuery, location: query, message: Name slug not found inside l at [5:23]

Location: europe-southwest1
Job ID: 67ce5918-cad2-4879-8ad1-0a8d3f21df92

2025-05-18 22:15:56,779 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:15:56,779 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:15:56,779 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:15:56,779 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:15:56,814 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:15:57,251 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:15:57,251 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:15:57,251 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:15:57,251 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:15:57,251 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:15:57,251 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:15:57,251 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:15:57,252 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:15:57,252 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:15:57,252 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:15:57,252 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:15:57,252 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:15:57,282 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:16:03,784 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:16:20,509 - ERROR - [main.py:519] - add_ingestion_date_from_filepath() - Error extracting ingestion date from filepath 'gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet': name 're' is not defined
2025-05-18 22:16:20,555 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:16:21,105 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:16:24,063 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:16:24,600 - ERROR - [main.py:390] - check_existing_keys_in_bigquery() - Error checking existing keys in BigQuery: no row field 'slug'
Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 376, in check_existing_keys_in_bigquery
    existing_keys.append((row.slug, row.ingestionDate))
                          ^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/table.py", line 1683, in __getattr__
    raise AttributeError("no row field {!r}".format(name))
AttributeError: no row field 'slug'
2025-05-18 22:17:00,615 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:17:00,615 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:17:00,615 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:17:00,616 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:17:00,649 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:17:01,202 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:17:01,202 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:17:01,202 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:17:01,202 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:17:01,203 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:17:01,203 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:17:01,203 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:17:01,203 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:17:01,203 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:17:01,203 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:17:01,203 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:17:01,203 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:17:01,234 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:17:07,619 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:17:23,821 - ERROR - [main.py:519] - add_ingestion_date_from_filepath() - Error extracting ingestion date from filepath 'gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet': name 're' is not defined
2025-05-18 22:17:23,868 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:17:24,367 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:17:27,118 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:17:27,566 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 15 existing key pairs in BigQuery
2025-05-18 22:17:27,656 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747603043
2025-05-18 22:17:27,656 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 15 duplicate keys from 6169 rows
2025-05-18 22:17:27,703 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6166 rows
2025-05-18 22:17:27,703 - INFO - [main.py:578] - <module>() - --- New Data Head ---
2025-05-18 22:17:27,712 - INFO - [main.py:579] - <module>() - 
           id                                                     title                                                                                                   url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   description_text advert_type advertiser_type_detail  status                created_at               modified_at property_type transaction_type   price price_currency price_period  area_m2 typology  bedrooms energy_certificate  bathrooms                               address_city address_county address_district   latitude  longitude   contact_name  contact_phone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    image_urls                                                                                                                        other_features features featuresByCategory featuresWithoutCategory                      map_details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 reverse_geocoding                                                            slug ingestionDate
0  18733258.0                                      AT3 centro da cidade                                    https://www.imovirtual.com/pt/anuncio/at3-centro-da-cidade-ID1gBnk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Arrendo T3 mobilado e cozinha equipada. A 100m do jardim do bacalhau, do pingo doce do Carmo, do hospital e de rpido acesso s universidades.  Entrada em Junho.   Condies de arrendamento:  3 ltimos recibos ordenado   ltimo IRS  1 renda +1 cauo   Mais informaes disponha.      AGENCY               business  active 2025-05-02 20:05:46+00:00 2025-05-02 20:05:46+00:00          FLAT             RENT   850.0            EUR          ms     92.0       T3       3.0                  E        1.0  Beja (Santiago Maior e So Joo Baptista)           Beja             Beja  38.008620  -7.859590         Vendas  +351990000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InlvbDJmc3p2ZGFqMTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.nUSq7Ry-KLIYXhPBQk0WF3E-47Jcc-VaRU2fFnOw6Ls/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjcweWxwMzl1a3ZrdTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.-mf0j5SbexFtN3TEyGrlWiwkq-RA6hO0IHZqQuFaYPk/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImJ1NGF6Z3g5Y2RldjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.ygtG1CP8mMr0G33X6WAndUcD5r79bmhzweRhO1zl68M/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InBvOXNia2JjMWFybjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.1XDBEUpSluk53ZOSzJZSPLIJ635mmFOwK8ccRjcx3cw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InFpcHduaDVoYWxxYzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.jYIKetFO9lWXsSATOFffdloRqsx_vPCn_PDe_GI0Ln4/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InUwNHV2cHYxYWowczEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.exkUMeS1NkO0G6yPYscDr3FFN0YgUtB-dkXFVHncqwc/image;s=1280x1024;q=80]  {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': 'Equipped'}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}          {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Beja, Beja', 'fullNameItems': ['Beja', 'Beja'], 'id': 'beja/beja', 'locationLevel': 'council', 'name': 'Beja', 'parentIds': ['beja']}, {'fullName': 'Beja (Santiago Maior e So Joo Baptista), Beja, Beja', 'fullNameItems': ['Beja (Santiago Maior e So Joo Baptista)', 'Beja', 'Beja'], 'id': 'beja/beja/beja-santiago-maior-e-sao-joao-baptista-', 'locationLevel': 'parish', 'name': 'Beja (Santiago Maior e So Joo Baptista)', 'parentIds': ['beja', 'beja/beja']}]}                                    at3-centro-da-cidade-ID1gBnk    2025-05-17
1  18715851.0  Arrenda-se Apartamento T1 na Costa Vicentina - Milfontes  https://www.imovirtual.com/pt/anuncio/arrenda-se-apartamento-t1-na-costa-vicentina-milfontes-ID1gvQz                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Arrenda-se T1, sala, cozinha, quarto e WC, mobilado.  Com roupas cama e atoalhados.  Localizado em Vila Nova Milfontes a 2km das praias das furnas, franquia e a meia hora das praias do Almograve e Porto Covo. Arrendamento para fins especiais transitrios.      AGENCY               business  active 2025-04-14 10:37:31+00:00 2025-04-14 10:37:31+00:00          FLAT             RENT   700.0            EUR          ms     50.0       T1       1.0  isento / em curso        1.0                     Vila Nova de Milfontes        Odemira             Beja  37.727060  -8.781740  Carlos Manuel  +351966044601                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImNvZHczbWtrMjUwejEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.YiLqNZn0GxEp3eceD15jeXU3lPoZPLfhfvD8MfVOqjo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Ijk0eDI3b2Z4dG9zOTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.WSFnMzjUsnVVyHwb0MqEvYk1sZNWIA5gqy3lguqCAXY/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InI5MTJudjI0ZmN3azItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.kycbT-9hkL7qtIsZfIb-_snVEPMwpFDljpXqHZA6rmM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjNwajFpZmk1OXNqLUVDT1NZU1RFTSIsInciOlt7ImZuIjoiNjlubHBhN2VjcW03MS1BUFQiLCJzIjoiMTQiLCJwIjoiMTAsLTEwIiwiYSI6IjAifV19.MuVG5sWRmGad9eiVhjwoKn_gQqC3PPgqTqpDHY0_6n8/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImI2a3N0ZmhlbGxzZDMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0._0I7SZRdPp60AtVm7rAO9NvtGEJq2WHETBj3XLbx59U/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}                                                             {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Odemira, Beja', 'fullNameItems': ['Odemira', 'Beja'], 'id': 'beja/odemira', 'locationLevel': 'council', 'name': 'Odemira', 'parentIds': ['beja']}, {'fullName': 'Vila Nova de Milfontes, Odemira, Beja', 'fullNameItems': ['Vila Nova de Milfontes', 'Odemira', 'Beja'], 'id': 'beja/odemira/vila-nova-de-milfontes', 'locationLevel': 'parish', 'name': 'Vila Nova de Milfontes', 'parentIds': ['beja', 'beja/odemira']}]}  arrenda-se-apartamento-t1-na-costa-vicentina-milfontes-ID1gvQz    2025-05-17
2  18652931.0                          Apartamento T2 para arrendamento                        https://www.imovirtual.com/pt/anuncio/apartamento-t2-para-arrendamento-ID1ggtJ  Apartamento T2 mobilado em Vila Nova de Milfontes   Descubra este magnfico apartamento T2 totalmente remodelado, situado no corao de Vila Nova de Milfontes, um dos destinos mais encantadores da Costa Alentejana. Com um design moderno e funcional, este apartamento oferece o equilbrio perfeito entre conforto e elegncia.   A propriedade conta com dois quartos espaosos, ideais para quem procura tranquilidade e bem-estar. Dispe ainda de duas casas de banho completas, garantindo e comodidade para os moradores. A cozinha, totalmente equipada com eletrodomsticos modernos, integra-se harmoniosamente com a sala de estar, criando um ambiente acolhedor e convidativo.   Alm do excelente estado de conservao e acabamentos de qualidade, este apartamento destaca-se pela sua localizao privilegiada, prximo de praias deslumbrantes, restaurantes tpicos e todos os servios essenciais.   CONDIES DE ARRENDAMENTO: 2 Rendas + 1 Cauo 3 ltimos recibos de ordenado IRS / Nota de liquidao   Fiadores    Se procura um espao sofisticado e pronto a habitar em Vila Nova de Milfontes, esta  a oportunidade ideal. Contacte-nos para mais informaes ou para agendar uma visita!  Apartamento T2 para arrendamento     Licena de Utilizao - 29/2008      AGENCY               business  active 2025-02-21 17:55:13+00:00 2025-02-21 17:55:13+00:00          FLAT             RENT  1200.0            EUR          ms     75.0       T2       2.0                  D        2.0                     Vila Nova de Milfontes        Odemira             Beja  37.730301  -8.781561          Place  +351923291192  [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImRhd3p0ODV6N2F0MzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.mDqrdNBiCh8_q2cvTD5RgBuJNpuW64V1mW7xe88F8Jo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImI1NDI5Z3Rha3dvZi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.egoUnaQvI02NlsOtDDKlMEHJfyo-6635xp7IiN9wZpg/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InNtYTBoejE3Yng1Zy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.L_YnllgEQvJc5psGsuCyo8ReKsbBXo4yKz-x4t7kyPc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InE5MWx6cXJ5dHczcjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.z_G5x9X3VYE3V12BGOhIcZxnhz8pR1UV0qyZWMrPyW4/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjE2NjJpbXV4eHl1NzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.huErwnDlOfcILh1rGuxofWmvtH6EJDC2J2p4q2NjNmc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImJpNmxsMmN4Yzg1OC1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.GamA00zuLIzSSw228kMEBSPe5r0sDyk-9K-F4qfmhAc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjNkZ3h2NzhpOG9wYTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.7dVfq7syM5Z6KKDcrbrw80fWtx97JneOBke7wtNzhUM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InVreXA5ZGZ0dHhxYi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.5BDynNlEbwx2HIPjhMeQGuJdvjpF89UlInN1wOoRAxE/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im5tbjN4cWlhazZwODEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.q-sqd7YrHFdkcMDCRaPOHfWUOp5YhdEzETD6zgO3qOM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InR4NzUxdzJ5dGtybDItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.sY1zyYPmjjEpoNV4HiUyLsMYr6cR5XwS07-4cJhyu7w/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjcxdXl6bnpwNnZsZzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.UuYKIXRNB8LLPFJp1oDvx1eB7jY_EeL75av7M9BX3d0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im9oamF3bTBxa2Y2ZTItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.yt_qWTZ9zrOnsFfxV1PjcFUE_ZjSQkTb2f0gQOzuIec/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImpzMXNuZnhvajYwdDMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.ZRHLUa178_B3kQ0qDEiJZn32THilaBCCmbV7QxId8Y0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im9pZXA0d2owOGl5YjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.r0lGOuOBVg_AUquJlY7ma-J0ciXjc3HKpjlgixAEAwk/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImYwem9xOTBzamIwNTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.woLxKP4eaBGMzgSAmNAYmlLlfZoYu9xCAoH4HcmHhiQ/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImFwdHRwZmFiZW55ZTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.AQvhZZG1T8AYaq9IcWFBe-jhTb8ctobllgW63Ql77zA/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []    {'radius': 0.0, 'zoom': 12.0}                                                             {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Odemira, Beja', 'fullNameItems': ['Odemira', 'Beja'], 'id': 'beja/odemira', 'locationLevel': 'council', 'name': 'Odemira', 'parentIds': ['beja']}, {'fullName': 'Vila Nova de Milfontes, Odemira, Beja', 'fullNameItems': ['Vila Nova de Milfontes', 'Odemira', 'Beja'], 'id': 'beja/odemira/vila-nova-de-milfontes', 'locationLevel': 'parish', 'name': 'Vila Nova de Milfontes', 'parentIds': ['beja', 'beja/odemira']}]}                        apartamento-t2-para-arrendamento-ID1ggtJ    2025-05-17
3  18743598.0                              Apartamento T3 em Cantanhede                            https://www.imovirtual.com/pt/anuncio/apartamento-t3-em-cantanhede-ID1gE46                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Alugo apartamento T3, no centro da cidade de Cantanhede, perto de vrios servios (cerca de 200m) das escolas, supermercados, hospital, centro de sade, farmcia, piscinas, etc.  O apartamento tem 1 cozinha (com placa de gs + forno eltrico, frigorifico), 3 quartos (com cho em flutuante madeira, no mobilados), 2 wc, 2 varandas, 1 sala e 1 dispensa.   Tem tambm lugar para estacionamento subterrneo.      AGENCY               business  active 2025-05-13 13:01:00+00:00 2025-05-13 13:01:00+00:00          FLAT             RENT   700.0            EUR          ms    130.0       T3       3.0  isento / em curso        2.0                      Cantanhede e Pocaria     Cantanhede          Coimbra  40.363000  -8.598730          Celso  +351927177876                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im0xYjdnbXR0ZGk5MzMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.9G_hPHDMxXuxkY6tY9gGTSszyEDums6GN2WejzB6UOc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjE4Mjh0Njl5Ym1lay1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.juR1qQDs-PEWtXRfYZwI4sS8NDPZKo_T3oxBQLFa9Q8/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InhsY2Rhd3Rqa3dndTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.Iy6m3NBMHRwKXe5LEboVFc9A-PpsA3lafz3cm3tynic/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Iml0YTdwb3BiMmd0Zy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.51l2Lo-W8FwjjFXMmMz87D_4fAa05xVH6szA-mh-Y9c/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InhrY29oa3RneTNrODMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.TCg4DPSmJ8tvarYTW31YZHcK3qdK4T9axlroSH7c-Ck/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InN5Y2o1eGtmeHJtNzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.9VVUI8qwtBeywTjWCppyfQ-tk1JpLhfrpvPhL9lsrKo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InNtMXBsMHFvM3VyYi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.OdU6oErRbNBIhpkY4qZFDbUDoSyAZZMCuIsEqaectq8/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': True, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}  {'locations': [{'fullName': 'Coimbra', 'fullNameItems': ['Coimbra'], 'id': 'coimbra', 'locationLevel': 'district', 'name': 'Coimbra', 'parentIds': []}, {'fullName': 'Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede', 'locationLevel': 'council', 'name': 'Cantanhede', 'parentIds': ['coimbra']}, {'fullName': 'Cantanhede e Pocaria, Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede e Pocaria', 'Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede/cantanhede-e-pocarica', 'locationLevel': 'parish', 'name': 'Cantanhede e Pocaria', 'parentIds': ['coimbra', 'coimbra/cantanhede']}]}                            apartamento-t3-em-cantanhede-ID1gE46    2025-05-17
4  18593304.0                                Apart. T1 Novo (a Estrear)                                 https://www.imovirtual.com/pt/anuncio/apart-t1-novo-a-estrear-ID1g0Y0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Localizado em Zona Nova da Cidade de Cantanhede. ( Edifcio ParqueExpo)   Prximo de Comrcio e Mercado.  timos acessos e parqueamento envolvente.  Ideal para 1 pessoa/ Casal.   Pormenores de condies de aluguer, agradeo contacto para marcar visita.      AGENCY               business  active 2025-01-06 22:31:41+00:00 2025-01-06 22:31:41+00:00          FLAT             RENT   680.0            EUR          ms     70.0       T1       1.0                 A+        1.0                      Cantanhede e Pocaria     Cantanhede          Coimbra  40.363000  -8.598730         Carlos  +351934516072                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjByemR5aHZ1aWtpNzMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.GM6y5WXUFCY5CQ_A0PRKjZ6DUaDgd_9ABKmDb6DCHI0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im0zdzRoMGVsbmFlZzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.tUj7neumG3gMKu8VioSGm_fH6WOuLyqnDjpdS6pcQLc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjdlZXh4NG5reG5wZjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.xwFZEgzqSaXRfRu33JFvaKdLoFA9vWJcdBIKQ0YtcxY/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjhxZ3Bldno1aHVwYTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.Rpgn3f8oddvzwpJUIHTLS-5gliEeLx1xCdjBI1flo-M/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjVjMzM0NTMzczc5MzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.OZQ0OjlD_77y1QcMtvIn6WrMuWi3weHMO2LDpV8Bodg/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InA1djBiN3M2ZWdqbjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.nKM-zXOYmhPbWZ2T7FuJKJI2_6F93QFlN5a3mss53lw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImQzMDA4ZGJrYXJiZy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.OeuaOpC38NQ0FWZDE9KYYtN-NKXRmLviY0YIG4sYfXw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IndvaGxuNWxnd2M5bS1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.BN5K3UE-s_hhcAiRFQR29q5c_p9xj5lYgihk5IuD-a0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImVzN3Vkb2dwcjRlajEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.GSxeC8r69AGhGh-vfKPo-2KXU7NjbXiQQQWNunGpPkw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InB3M2xyaTF0cGxtcjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.L3e1qFGDhZDnSqC8_RSC5Ak3wuh7_ZMGiTslz1kUpAI/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImdsZjN1YXVjZnZmYS1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.Nzohrwk5hNT1Cm-jLuO325ug6_nCiDFjlKB7cBapL1k/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImFyemhuN2s3ZG5naTItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.7yZRavbUXGICqX0jbS7r2d1_qMyVaoCKKoSfgTKRPiY/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}  {'locations': [{'fullName': 'Coimbra', 'fullNameItems': ['Coimbra'], 'id': 'coimbra', 'locationLevel': 'district', 'name': 'Coimbra', 'parentIds': []}, {'fullName': 'Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede', 'locationLevel': 'council', 'name': 'Cantanhede', 'parentIds': ['coimbra']}, {'fullName': 'Cantanhede e Pocaria, Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede e Pocaria', 'Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede/cantanhede-e-pocarica', 'locationLevel': 'parish', 'name': 'Cantanhede e Pocaria', 'parentIds': ['coimbra', 'coimbra/cantanhede']}]}                                 apart-t1-novo-a-estrear-ID1g0Y0    2025-05-17
2025-05-18 22:17:27,713 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:17:27,745 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:17:28,101 - ERROR - [_pandas_helpers.py:383] - bq_to_arrow_array() - Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:17:28,101 - ERROR - [main.py:280] - load_to_bigquery() - Error loading data to BigQuery: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 377, in bq_to_arrow_array
    return pyarrow.ListArray.from_pandas(series, type=arrow_type)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1226, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 90, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: Expected bytes, got a 'dict' object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/miguel/Projects/imovirtual/imovirtual/events/listings_gcs_daily_incremental_load/main.py", line 271, in load_to_bigquery
    job = bq_client.load_table_from_dataframe(df, full_table_id, job_config=job_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2812, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 744, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 687, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
  File "/home/miguel/.local/lib/python3.12/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 384, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "featuresByCategory" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-05-18 22:28:08,674 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:28:08,681 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:28:08,681 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:28:08,681 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:28:08,713 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:28:09,158 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:28:09,158 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:28:09,158 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:28:09,158 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:28:09,158 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:28:09,158 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:28:09,159 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:09,159 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:09,159 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:09,159 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:28:09,159 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:09,159 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:09,190 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:28:15,607 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:28:41,962 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:28:41,962 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:28:41,962 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:28:41,962 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:28:41,996 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:28:42,468 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:28:42,468 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:28:42,468 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:28:42,468 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:28:42,468 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:28:42,468 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:28:42,468 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:42,468 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:42,468 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:42,468 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:28:42,468 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:42,468 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:42,500 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:28:48,957 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:28:56,522 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:28:56,522 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:28:56,522 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:28:56,522 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:28:56,554 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:28:56,995 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:28:56,995 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:28:56,995 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:28:56,995 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:28:56,995 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:28:56,996 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:28:56,996 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:56,996 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:56,996 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:28:56,996 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:28:56,996 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:56,996 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:28:57,032 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:29:03,465 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:29:39,956 - INFO - [main.py:531] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:29:39,956 - INFO - [main.py:532] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:29:39,956 - INFO - [main.py:538] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:29:39,956 - INFO - [main.py:134] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:29:39,990 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:29:40,426 - INFO - [main.py:170] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:29:40,426 - INFO - [main.py:173] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:29:40,426 - INFO - [main.py:173] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:29:40,426 - INFO - [main.py:173] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:29:40,426 - INFO - [main.py:173] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:29:40,426 - INFO - [main.py:173] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:29:40,426 - INFO - [main.py:179] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:29:40,426 - INFO - [main.py:180] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:29:40,426 - INFO - [main.py:181] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:29:40,427 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:29:40,427 - INFO - [main.py:548] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:29:40,427 - INFO - [main.py:204] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:29:40,462 - INFO - [main.py:84] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:29:46,801 - INFO - [main.py:231] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:30:03,360 - ERROR - [main.py:519] - add_ingestion_date_from_filepath() - Error extracting ingestion date from filepath 'gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet': name 're' is not defined
2025-05-18 22:30:03,405 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:30:04,005 - INFO - [main.py:347] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:30:06,453 - INFO - [main.py:369] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:30:06,966 - INFO - [main.py:378] - check_existing_keys_in_bigquery() - Found 15 existing key pairs in BigQuery
2025-05-18 22:30:07,055 - INFO - [main.py:383] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747603803
2025-05-18 22:30:07,055 - INFO - [main.py:405] - filter_out_duplicates() - Filtering out 15 duplicate keys from 6169 rows
2025-05-18 22:30:07,104 - INFO - [main.py:413] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6166 rows
2025-05-18 22:30:07,104 - INFO - [main.py:578] - <module>() - --- New Data Head ---
2025-05-18 22:30:07,113 - INFO - [main.py:579] - <module>() - 
           id                                                     title                                                                                                   url                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   description_text advert_type advertiser_type_detail  status                created_at               modified_at property_type transaction_type   price price_currency price_period  area_m2 typology  bedrooms energy_certificate  bathrooms                               address_city address_county address_district   latitude  longitude   contact_name  contact_phone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    image_urls                                                                                                                        other_features features featuresByCategory featuresWithoutCategory                      map_details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 reverse_geocoding                                                            slug ingestionDate
0  18733258.0                                      AT3 centro da cidade                                    https://www.imovirtual.com/pt/anuncio/at3-centro-da-cidade-ID1gBnk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Arrendo T3 mobilado e cozinha equipada. A 100m do jardim do bacalhau, do pingo doce do Carmo, do hospital e de rpido acesso s universidades.  Entrada em Junho.   Condies de arrendamento:  3 ltimos recibos ordenado   ltimo IRS  1 renda +1 cauo   Mais informaes disponha.      AGENCY               business  active 2025-05-02 20:05:46+00:00 2025-05-02 20:05:46+00:00          FLAT             RENT   850.0            EUR          ms     92.0       T3       3.0                  E        1.0  Beja (Santiago Maior e So Joo Baptista)           Beja             Beja  38.008620  -7.859590         Vendas  +351990000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InlvbDJmc3p2ZGFqMTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.nUSq7Ry-KLIYXhPBQk0WF3E-47Jcc-VaRU2fFnOw6Ls/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjcweWxwMzl1a3ZrdTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.-mf0j5SbexFtN3TEyGrlWiwkq-RA6hO0IHZqQuFaYPk/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImJ1NGF6Z3g5Y2RldjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.ygtG1CP8mMr0G33X6WAndUcD5r79bmhzweRhO1zl68M/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InBvOXNia2JjMWFybjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.1XDBEUpSluk53ZOSzJZSPLIJ635mmFOwK8ccRjcx3cw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InFpcHduaDVoYWxxYzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.jYIKetFO9lWXsSATOFffdloRqsx_vPCn_PDe_GI0Ln4/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InUwNHV2cHYxYWowczEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.exkUMeS1NkO0G6yPYscDr3FFN0YgUtB-dkXFVHncqwc/image;s=1280x1024;q=80]  {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': 'Equipped'}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}          {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Beja, Beja', 'fullNameItems': ['Beja', 'Beja'], 'id': 'beja/beja', 'locationLevel': 'council', 'name': 'Beja', 'parentIds': ['beja']}, {'fullName': 'Beja (Santiago Maior e So Joo Baptista), Beja, Beja', 'fullNameItems': ['Beja (Santiago Maior e So Joo Baptista)', 'Beja', 'Beja'], 'id': 'beja/beja/beja-santiago-maior-e-sao-joao-baptista-', 'locationLevel': 'parish', 'name': 'Beja (Santiago Maior e So Joo Baptista)', 'parentIds': ['beja', 'beja/beja']}]}                                    at3-centro-da-cidade-ID1gBnk    2025-05-17
1  18715851.0  Arrenda-se Apartamento T1 na Costa Vicentina - Milfontes  https://www.imovirtual.com/pt/anuncio/arrenda-se-apartamento-t1-na-costa-vicentina-milfontes-ID1gvQz                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Arrenda-se T1, sala, cozinha, quarto e WC, mobilado.  Com roupas cama e atoalhados.  Localizado em Vila Nova Milfontes a 2km das praias das furnas, franquia e a meia hora das praias do Almograve e Porto Covo. Arrendamento para fins especiais transitrios.      AGENCY               business  active 2025-04-14 10:37:31+00:00 2025-04-14 10:37:31+00:00          FLAT             RENT   700.0            EUR          ms     50.0       T1       1.0  isento / em curso        1.0                     Vila Nova de Milfontes        Odemira             Beja  37.727060  -8.781740  Carlos Manuel  +351966044601                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImNvZHczbWtrMjUwejEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.YiLqNZn0GxEp3eceD15jeXU3lPoZPLfhfvD8MfVOqjo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Ijk0eDI3b2Z4dG9zOTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.WSFnMzjUsnVVyHwb0MqEvYk1sZNWIA5gqy3lguqCAXY/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InI5MTJudjI0ZmN3azItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.kycbT-9hkL7qtIsZfIb-_snVEPMwpFDljpXqHZA6rmM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjNwajFpZmk1OXNqLUVDT1NZU1RFTSIsInciOlt7ImZuIjoiNjlubHBhN2VjcW03MS1BUFQiLCJzIjoiMTQiLCJwIjoiMTAsLTEwIiwiYSI6IjAifV19.MuVG5sWRmGad9eiVhjwoKn_gQqC3PPgqTqpDHY0_6n8/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImI2a3N0ZmhlbGxzZDMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0._0I7SZRdPp60AtVm7rAO9NvtGEJq2WHETBj3XLbx59U/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}                                                             {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Odemira, Beja', 'fullNameItems': ['Odemira', 'Beja'], 'id': 'beja/odemira', 'locationLevel': 'council', 'name': 'Odemira', 'parentIds': ['beja']}, {'fullName': 'Vila Nova de Milfontes, Odemira, Beja', 'fullNameItems': ['Vila Nova de Milfontes', 'Odemira', 'Beja'], 'id': 'beja/odemira/vila-nova-de-milfontes', 'locationLevel': 'parish', 'name': 'Vila Nova de Milfontes', 'parentIds': ['beja', 'beja/odemira']}]}  arrenda-se-apartamento-t1-na-costa-vicentina-milfontes-ID1gvQz    2025-05-17
2  18652931.0                          Apartamento T2 para arrendamento                        https://www.imovirtual.com/pt/anuncio/apartamento-t2-para-arrendamento-ID1ggtJ  Apartamento T2 mobilado em Vila Nova de Milfontes   Descubra este magnfico apartamento T2 totalmente remodelado, situado no corao de Vila Nova de Milfontes, um dos destinos mais encantadores da Costa Alentejana. Com um design moderno e funcional, este apartamento oferece o equilbrio perfeito entre conforto e elegncia.   A propriedade conta com dois quartos espaosos, ideais para quem procura tranquilidade e bem-estar. Dispe ainda de duas casas de banho completas, garantindo e comodidade para os moradores. A cozinha, totalmente equipada com eletrodomsticos modernos, integra-se harmoniosamente com a sala de estar, criando um ambiente acolhedor e convidativo.   Alm do excelente estado de conservao e acabamentos de qualidade, este apartamento destaca-se pela sua localizao privilegiada, prximo de praias deslumbrantes, restaurantes tpicos e todos os servios essenciais.   CONDIES DE ARRENDAMENTO: 2 Rendas + 1 Cauo 3 ltimos recibos de ordenado IRS / Nota de liquidao   Fiadores    Se procura um espao sofisticado e pronto a habitar em Vila Nova de Milfontes, esta  a oportunidade ideal. Contacte-nos para mais informaes ou para agendar uma visita!  Apartamento T2 para arrendamento     Licena de Utilizao - 29/2008      AGENCY               business  active 2025-02-21 17:55:13+00:00 2025-02-21 17:55:13+00:00          FLAT             RENT  1200.0            EUR          ms     75.0       T2       2.0                  D        2.0                     Vila Nova de Milfontes        Odemira             Beja  37.730301  -8.781561          Place  +351923291192  [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImRhd3p0ODV6N2F0MzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.mDqrdNBiCh8_q2cvTD5RgBuJNpuW64V1mW7xe88F8Jo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImI1NDI5Z3Rha3dvZi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.egoUnaQvI02NlsOtDDKlMEHJfyo-6635xp7IiN9wZpg/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InNtYTBoejE3Yng1Zy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.L_YnllgEQvJc5psGsuCyo8ReKsbBXo4yKz-x4t7kyPc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InE5MWx6cXJ5dHczcjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.z_G5x9X3VYE3V12BGOhIcZxnhz8pR1UV0qyZWMrPyW4/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjE2NjJpbXV4eHl1NzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.huErwnDlOfcILh1rGuxofWmvtH6EJDC2J2p4q2NjNmc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImJpNmxsMmN4Yzg1OC1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.GamA00zuLIzSSw228kMEBSPe5r0sDyk-9K-F4qfmhAc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjNkZ3h2NzhpOG9wYTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.7dVfq7syM5Z6KKDcrbrw80fWtx97JneOBke7wtNzhUM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InVreXA5ZGZ0dHhxYi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.5BDynNlEbwx2HIPjhMeQGuJdvjpF89UlInN1wOoRAxE/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im5tbjN4cWlhazZwODEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.q-sqd7YrHFdkcMDCRaPOHfWUOp5YhdEzETD6zgO3qOM/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InR4NzUxdzJ5dGtybDItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.sY1zyYPmjjEpoNV4HiUyLsMYr6cR5XwS07-4cJhyu7w/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjcxdXl6bnpwNnZsZzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.UuYKIXRNB8LLPFJp1oDvx1eB7jY_EeL75av7M9BX3d0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im9oamF3bTBxa2Y2ZTItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.yt_qWTZ9zrOnsFfxV1PjcFUE_ZjSQkTb2f0gQOzuIec/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImpzMXNuZnhvajYwdDMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.ZRHLUa178_B3kQ0qDEiJZn32THilaBCCmbV7QxId8Y0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im9pZXA0d2owOGl5YjEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.r0lGOuOBVg_AUquJlY7ma-J0ciXjc3HKpjlgixAEAwk/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImYwem9xOTBzamIwNTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.woLxKP4eaBGMzgSAmNAYmlLlfZoYu9xCAoH4HcmHhiQ/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImFwdHRwZmFiZW55ZTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.AQvhZZG1T8AYaq9IcWFBe-jhTb8ctobllgW63Ql77zA/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []    {'radius': 0.0, 'zoom': 12.0}                                                             {'locations': [{'fullName': 'Beja', 'fullNameItems': ['Beja'], 'id': 'beja', 'locationLevel': 'district', 'name': 'Beja', 'parentIds': []}, {'fullName': 'Odemira, Beja', 'fullNameItems': ['Odemira', 'Beja'], 'id': 'beja/odemira', 'locationLevel': 'council', 'name': 'Odemira', 'parentIds': ['beja']}, {'fullName': 'Vila Nova de Milfontes, Odemira, Beja', 'fullNameItems': ['Vila Nova de Milfontes', 'Odemira', 'Beja'], 'id': 'beja/odemira/vila-nova-de-milfontes', 'locationLevel': 'parish', 'name': 'Vila Nova de Milfontes', 'parentIds': ['beja', 'beja/odemira']}]}                        apartamento-t2-para-arrendamento-ID1ggtJ    2025-05-17
3  18743598.0                              Apartamento T3 em Cantanhede                            https://www.imovirtual.com/pt/anuncio/apartamento-t3-em-cantanhede-ID1gE46                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Alugo apartamento T3, no centro da cidade de Cantanhede, perto de vrios servios (cerca de 200m) das escolas, supermercados, hospital, centro de sade, farmcia, piscinas, etc.  O apartamento tem 1 cozinha (com placa de gs + forno eltrico, frigorifico), 3 quartos (com cho em flutuante madeira, no mobilados), 2 wc, 2 varandas, 1 sala e 1 dispensa.   Tem tambm lugar para estacionamento subterrneo.      AGENCY               business  active 2025-05-13 13:01:00+00:00 2025-05-13 13:01:00+00:00          FLAT             RENT   700.0            EUR          ms    130.0       T3       3.0  isento / em curso        2.0                      Cantanhede e Pocaria     Cantanhede          Coimbra  40.363000  -8.598730          Celso  +351927177876                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im0xYjdnbXR0ZGk5MzMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.9G_hPHDMxXuxkY6tY9gGTSszyEDums6GN2WejzB6UOc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjE4Mjh0Njl5Ym1lay1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.juR1qQDs-PEWtXRfYZwI4sS8NDPZKo_T3oxBQLFa9Q8/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InhsY2Rhd3Rqa3dndTMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.Iy6m3NBMHRwKXe5LEboVFc9A-PpsA3lafz3cm3tynic/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Iml0YTdwb3BiMmd0Zy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.51l2Lo-W8FwjjFXMmMz87D_4fAa05xVH6szA-mh-Y9c/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InhrY29oa3RneTNrODMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.TCg4DPSmJ8tvarYTW31YZHcK3qdK4T9axlroSH7c-Ck/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InN5Y2o1eGtmeHJtNzEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.9VVUI8qwtBeywTjWCppyfQ-tk1JpLhfrpvPhL9lsrKo/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InNtMXBsMHFvM3VyYi1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.OdU6oErRbNBIhpkY4qZFDbUDoSyAZZMCuIsEqaectq8/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': True, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}  {'locations': [{'fullName': 'Coimbra', 'fullNameItems': ['Coimbra'], 'id': 'coimbra', 'locationLevel': 'district', 'name': 'Coimbra', 'parentIds': []}, {'fullName': 'Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede', 'locationLevel': 'council', 'name': 'Cantanhede', 'parentIds': ['coimbra']}, {'fullName': 'Cantanhede e Pocaria, Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede e Pocaria', 'Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede/cantanhede-e-pocarica', 'locationLevel': 'parish', 'name': 'Cantanhede e Pocaria', 'parentIds': ['coimbra', 'coimbra/cantanhede']}]}                            apartamento-t3-em-cantanhede-ID1gE46    2025-05-17
4  18593304.0                                Apart. T1 Novo (a Estrear)                                 https://www.imovirtual.com/pt/anuncio/apart-t1-novo-a-estrear-ID1g0Y0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Localizado em Zona Nova da Cidade de Cantanhede. ( Edifcio ParqueExpo)   Prximo de Comrcio e Mercado.  timos acessos e parqueamento envolvente.  Ideal para 1 pessoa/ Casal.   Pormenores de condies de aluguer, agradeo contacto para marcar visita.      AGENCY               business  active 2025-01-06 22:31:41+00:00 2025-01-06 22:31:41+00:00          FLAT             RENT   680.0            EUR          ms     70.0       T1       1.0                 A+        1.0                      Cantanhede e Pocaria     Cantanhede          Coimbra  40.363000  -8.598730         Carlos  +351934516072                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjByemR5aHZ1aWtpNzMtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.GM6y5WXUFCY5CQ_A0PRKjZ6DUaDgd_9ABKmDb6DCHI0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6Im0zdzRoMGVsbmFlZzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.tUj7neumG3gMKu8VioSGm_fH6WOuLyqnDjpdS6pcQLc/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjdlZXh4NG5reG5wZjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.xwFZEgzqSaXRfRu33JFvaKdLoFA9vWJcdBIKQ0YtcxY/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjhxZ3Bldno1aHVwYTEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.Rpgn3f8oddvzwpJUIHTLS-5gliEeLx1xCdjBI1flo-M/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IjVjMzM0NTMzczc5MzItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.OZQ0OjlD_77y1QcMtvIn6WrMuWi3weHMO2LDpV8Bodg/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InA1djBiN3M2ZWdqbjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.nKM-zXOYmhPbWZ2T7FuJKJI2_6F93QFlN5a3mss53lw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImQzMDA4ZGJrYXJiZy1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.OeuaOpC38NQ0FWZDE9KYYtN-NKXRmLviY0YIG4sYfXw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6IndvaGxuNWxnd2M5bS1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.BN5K3UE-s_hhcAiRFQR29q5c_p9xj5lYgihk5IuD-a0/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImVzN3Vkb2dwcjRlajEtRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.GSxeC8r69AGhGh-vfKPo-2KXU7NjbXiQQQWNunGpPkw/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6InB3M2xyaTF0cGxtcjItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.L3e1qFGDhZDnSqC8_RSC5Ak3wuh7_ZMGiTslz1kUpAI/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImdsZjN1YXVjZnZmYS1FQ09TWVNURU0iLCJ3IjpbeyJmbiI6IjY5bmxwYTdlY3FtNzEtQVBUIiwicyI6IjE0IiwicCI6IjEwLC0xMCIsImEiOiIwIn1dfQ.Nzohrwk5hNT1Cm-jLuO325ug6_nCiDFjlKB7cBapL1k/image;s=1280x1024;q=80, https://ireland.apollo.olxcdn.com/v1/files/eyJmbiI6ImFyemhuN2s3ZG5naTItRUNPU1lTVEVNIiwidyI6W3siZm4iOiI2OW5scGE3ZWNxbTcxLUFQVCIsInMiOiIxNCIsInAiOiIxMCwtMTAiLCJhIjoiMCJ9XX0.7yZRavbUXGICqX0jbS7r2d1_qMyVaoCKKoSfgTKRPiY/image;s=1280x1024;q=80]        {'lift': False, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []  {'radius': 100.0, 'zoom': 12.0}  {'locations': [{'fullName': 'Coimbra', 'fullNameItems': ['Coimbra'], 'id': 'coimbra', 'locationLevel': 'district', 'name': 'Coimbra', 'parentIds': []}, {'fullName': 'Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede', 'locationLevel': 'council', 'name': 'Cantanhede', 'parentIds': ['coimbra']}, {'fullName': 'Cantanhede e Pocaria, Cantanhede, Coimbra', 'fullNameItems': ['Cantanhede e Pocaria', 'Cantanhede', 'Coimbra'], 'id': 'coimbra/cantanhede/cantanhede-e-pocarica', 'locationLevel': 'parish', 'name': 'Cantanhede e Pocaria', 'parentIds': ['coimbra', 'coimbra/cantanhede']}]}                                 apart-t1-novo-a-estrear-ID1g0Y0    2025-05-17
2025-05-18 22:30:07,114 - INFO - [main.py:258] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:30:07,163 - INFO - [main.py:102] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:30:11,965 - INFO - [main.py:276] - load_to_bigquery() - Loaded 6166 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:30:11,966 - INFO - [main.py:277] - load_to_bigquery() - Table now has 37011 rows total
2025-05-18 22:30:11,966 - INFO - [main.py:583] - <module>() - Processing completed successfully
2025-05-18 22:32:12,980 - INFO - [main.py:533] - <module>() - Using bucket: miguelsiloli-housing-data
2025-05-18 22:32:12,980 - INFO - [main.py:534] - <module>() - Using subfolder path: staging/imovirtual_listings
2025-05-18 22:32:12,980 - INFO - [main.py:540] - <module>() - Searching for latest file in gs://miguelsiloli-housing-data/staging/imovirtual_listings
2025-05-18 22:32:12,980 - INFO - [main.py:136] - find_latest_file_in_gcs() - Searching for latest '.parquet' file by timestamp in: gs://miguelsiloli-housing-data/staging/imovirtual_listings/
2025-05-18 22:32:13,015 - INFO - [main.py:86] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:32:13,466 - INFO - [main.py:172] - find_latest_file_in_gcs() - Top 5 latest files by timestamp:
2025-05-18 22:32:13,466 - INFO - [main.py:175] - find_latest_file_in_gcs() -   1. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet (created: 2025-05-17 12:33:13.937000+00:00)
2025-05-18 22:32:13,466 - INFO - [main.py:175] - find_latest_file_in_gcs() -   2. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-15.parquet (created: 2025-05-15 23:54:43.514000+00:00)
2025-05-18 22:32:13,466 - INFO - [main.py:175] - find_latest_file_in_gcs() -   3. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-14.parquet (created: 2025-05-14 19:35:23.017000+00:00)
2025-05-18 22:32:13,466 - INFO - [main.py:175] - find_latest_file_in_gcs() -   4. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-13.parquet (created: 2025-05-13 11:58:58.328000+00:00)
2025-05-18 22:32:13,466 - INFO - [main.py:175] - find_latest_file_in_gcs() -   5. staging/imovirtual_listings/staging_imovirtual_listings_2025-05-10.parquet (created: 2025-05-10 21:26:46.926000+00:00)
2025-05-18 22:32:13,466 - INFO - [main.py:181] - find_latest_file_in_gcs() - Latest file found (by timestamp): gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:32:13,466 - INFO - [main.py:182] - find_latest_file_in_gcs() -   Created: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:32:13,466 - INFO - [main.py:183] - find_latest_file_in_gcs() -   Updated: 2025-05-17 12:33:13.937000+00:00
2025-05-18 22:32:13,466 - INFO - [main.py:184] - find_latest_file_in_gcs() -   Size: 48228300 bytes
2025-05-18 22:32:13,466 - INFO - [main.py:550] - <module>() - Processing file: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:32:13,466 - INFO - [main.py:206] - read_parquet_from_gcs() - Reading Parquet file from GCS: gs://miguelsiloli-housing-data/staging/imovirtual_listings/staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:32:13,502 - INFO - [main.py:86] - get_storage_client() - Creating storage client for project: poised-space-456813-t0
2025-05-18 22:32:19,858 - INFO - [main.py:233] - read_parquet_from_gcs() - Successfully read Parquet file with GCS client: 6169 rows
2025-05-18 22:32:36,338 - INFO - [main.py:513] - add_ingestion_date_from_filepath() - Successfully set 'ingestionDate' to 2025-05-17 from filename: staging_imovirtual_listings_2025-05-17.parquet
2025-05-18 22:32:36,382 - INFO - [main.py:104] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:32:36,848 - INFO - [main.py:349] - check_existing_keys_in_bigquery() - Creating temporary lookup table with 6164 key pairs
2025-05-18 22:32:39,142 - INFO - [main.py:371] - check_existing_keys_in_bigquery() - Checking for existing key pairs in BigQuery
2025-05-18 22:32:39,780 - INFO - [main.py:380] - check_existing_keys_in_bigquery() - Found 6175 existing key pairs in BigQuery
2025-05-18 22:32:39,861 - INFO - [main.py:385] - check_existing_keys_in_bigquery() - Deleted temporary table poised-space-456813-t0.imovirtual_listings_temp.temp_lookup_1747603956
2025-05-18 22:32:39,861 - INFO - [main.py:407] - filter_out_duplicates() - Filtering out 6175 duplicate keys from 6169 rows
2025-05-18 22:32:39,906 - INFO - [main.py:415] - filter_out_duplicates() - Filtered DataFrame from 6169 to 6 rows
2025-05-18 22:32:39,906 - INFO - [main.py:580] - <module>() - --- New Data Head ---
2025-05-18 22:32:39,913 - INFO - [main.py:581] - <module>() - 
      id title   url description_text advert_type advertiser_type_detail status created_at modified_at property_type transaction_type  price price_currency price_period  area_m2 typology  bedrooms energy_certificate  bathrooms address_city address_county address_district  latitude  longitude contact_name contact_phone image_urls                                                                                                                 other_features features featuresByCategory featuresWithoutCategory map_details reverse_geocoding  slug ingestionDate
3555 NaN  None  None                         None                   None   None        NaT         NaT          None             None    NaN           None         None      NaN     None       NaN               None        NaN         None           None             None       NaN        NaN         None          None         []  {'lift': None, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []          {}                {}  None    2025-05-17
3617 NaN  None  None                         None                   None   None        NaT         NaT          None             None    NaN           None         None      NaN     None       NaN               None        NaN         None           None             None       NaN        NaN         None          None         []  {'lift': None, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []          {}                {}  None    2025-05-17
4394 NaN  None  None                         None                   None   None        NaT         NaT          None             None    NaN           None         None      NaN     None       NaN               None        NaN         None           None             None       NaN        NaN         None          None         []  {'lift': None, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []          {}                {}  None    2025-05-17
5859 NaN  None  None                         None                   None   None        NaT         NaT          None             None    NaN           None         None      NaN     None       NaN               None        NaN         None           None             None       NaN        NaN         None          None         []  {'lift': None, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []          {}                {}  None    2025-05-17
5891 NaN  None  None                         None                   None   None        NaT         NaT          None             None    NaN           None         None      NaN     None       NaN               None        NaN         None           None             None       NaN        NaN         None          None         []  {'lift': None, 'garage': None, 'heating': None, 'fireplace': None, 'balcony': None, 'suite': None, 'kitchen_equipment': None}       []                 []                      []          {}                {}  None    2025-05-17
2025-05-18 22:32:39,913 - INFO - [main.py:260] - load_to_bigquery() - Loading data to BigQuery table: poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:32:39,944 - INFO - [main.py:104] - get_bigquery_client() - Creating BigQuery client for project: poised-space-456813-t0
2025-05-18 22:32:42,357 - INFO - [main.py:278] - load_to_bigquery() - Loaded 6 rows to poised-space-456813-t0.imovirtual_listings.staging_imovirtual_listings
2025-05-18 22:32:42,357 - INFO - [main.py:279] - load_to_bigquery() - Table now has 37017 rows total
2025-05-18 22:32:42,357 - INFO - [main.py:585] - <module>() - Processing completed successfully
